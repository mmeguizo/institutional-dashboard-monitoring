<p-dialog
    header="Printing Details"
    [(visible)]="printingHead"
    [style]="{ width: '25rem' }"
>
    <span class="p-text-secondary block mb-5">Prepared By:</span>
    <div class="flex align-items-center gap-3 mb-3">
        <label for="username" class="font-semibold w-6rem">Name</label>
        <input
            pInputText
            #nameInput
            id="name"
            placeholder="e.g Benrie Nufable, PHD. TM"
            class="flex-auto"
            autocomplete="off"
            [(ngModel)]="preparedByValue"
        />
    </div>
    <div class="flex align-items-center gap-3 mb-5">
        <label for="email" class="font-semibold w-6rem">Office</label>
        <input
            pInputText
            id="office"
            #officeInput
            placeholder="e.g MIS Head - DPO"
            class="flex-auto"
            autocomplete="off"
            [(ngModel)]="preparedByofficeValue"
        />
    </div>

    <span class="p-text-secondary block mb-5">Counter Checked by:</span>
    <div class="flex align-items-center gap-3 mb-3">
        <label for="username" class="font-semibold w-6rem">Name</label>
        <input
            pInputText
            #nameInput
            id="name"
            placeholder="e.g Yrika Marie R. Dusaran, PhD"
            class="flex-auto"
            autocomplete="off"
            [(ngModel)]="counterCheckedValue"
        />
    </div>
    <div class="flex align-items-center gap-3 mb-5">
        <label for="email" class="font-semibold w-6rem">Office</label>
        <input
            pInputText
            id="office"
            #officeInput
            placeholder="e.g Director for Quality Management"
            class="flex-auto"
            autocomplete="off"
            [(ngModel)]="counterCheckedofficeValue"
        />
    </div>

    <span class="p-text-secondary block mb-5">Verified By:</span>
    <div class="flex align-items-center gap-3 mb-3">
        <label for="username" class="font-semibold w-6rem">Name</label>
        <input
            pInputText
            #nameInput
            id="name"
            placeholder="e.g Rosalinda S. Tuvilla"
            class="flex-auto"
            autocomplete="off"
            [(ngModel)]="reviewedByValue"
        />
    </div>
    <div class="flex align-items-center gap-3 mb-5">
        <label for="email" class="font-semibold w-6rem">Office</label>
        <input
            pInputText
            id="office"
            #officeInput
            placeholder="e.g Chief Adminstrative Officer - Admin"
            class="flex-auto"
            autocomplete="off"
            [(ngModel)]="reviewedByofficeValue"
        />
    </div>

    <span class="p-text-secondary block mb-5">Approved By:</span>
    <div class="flex align-items-center gap-3 mb-3">
        <label for="username" class="font-semibold w-6rem">Name</label>
        <input
            pInputText
            #nameInput
            id="name"
            placeholder="e.g Rosalinda S. Tuvilla"
            class="flex-auto"
            autocomplete="off"
            [(ngModel)]="verifiedByValue"
        />
    </div>
    <div class="flex align-items-center gap-3 mb-5">
        <label for="email" class="font-semibold w-6rem">Office</label>
        <input
            pInputText
            id="office"
            #officeInput
            placeholder="e.g Chief Adminstrative Officer - Admin"
            class="flex-auto"
            autocomplete="off"
            [(ngModel)]="verifiedByofficeValue"
        />
    </div>

    <div class="flex justify-content-end gap-2">
        <p-button
            label="Cancel"
            severity="secondary"
            (onClick)="printingHead = false"
        />
        <p-button label="Save" (onClick)="printPdf(); printingHead = false" />
    </div>
</p-dialog>
<table id="print" [ngClass]="{ hidden: !isPrintableVisible }">
    <thead>
        <tr>
            <th colspan="2">Breakthrough Goals and Strategic Objective</th>
            <th>Functional Objectives</th>
            <th>Performance Indicators</th>
            <th>Target</th>
            <th>Formula</th>
            <th>Programs, Projects or Activities</th>
            <th>Responsible Persons & Partners</th>
            <th>Frequency of Monitoring</th>
            <th>Means of Verification (Data Source)</th>
            <th>Budget</th>
        </tr>
    </thead>
    <tbody *ngIf="objectiveDatas?.length != 0">
        <tr *ngFor="let obj of objectiveDatas; let i = index">
            <td
                colspan="2"
                *ngIf="i === 0"
                [attr.rowspan]="objectiveDatas.length"
            >
                {{
                    subObjectiveHeaders + " (" + obj.strategic_objective + ")"
                        | titlecase
                }}
            </td>
            <td>{{ obj.functional_objective | titlecase }}</td>
            <td>{{ obj.performance_indicator | titlecase }}</td>
            <td>{{ obj.target }}</td>
            <td>{{ obj.formula | titlecase }}</td>
            <td>{{ obj.programs | titlecase }}</td>
            <td>{{ obj.responsible_persons | titlecase }}</td>
            <td>
                {{ getFrequencyKeys(obj.frequency_monitoring) | titlecase }}
            </td>
            <td>{{ obj.data_source | titlecase }}</td>
            <td>{{ obj.budget | peso }}</td>
        </tr>
    </tbody>
</table>

<p-dialog
    header="PRINT"
    [(visible)]="printingQOMHead"
    [style]="{ width: '25rem' }"
>
    <span class="p-text-secondary block mb-5">Prepared By:</span>
    <div class="flex align-items-center gap-3 mb-3">
        <label for="username" class="font-semibold w-6rem">Name</label>
        <input
            pInputText
            #nameInput
            id="name"
            placeholder="e.g Benrie Nufable, PHD. TM"
            class="flex-auto"
            autocomplete="off"
            [(ngModel)]="preparedByValue"
        />
    </div>
    <div class="flex align-items-center gap-3 mb-5">
        <label for="email" class="font-semibold w-6rem">Office</label>
        <input
            pInputText
            id="office"
            #officeInput
            placeholder="e.g MIS Head - DPO"
            class="flex-auto"
            autocomplete="off"
            [(ngModel)]="preparedByofficeValue"
        />
    </div>

    <span class="p-text-secondary block mb-5">Counter Checked by:</span>
    <div class="flex align-items-center gap-3 mb-3">
        <label for="username" class="font-semibold w-6rem">Name</label>
        <input
            pInputText
            #nameInput
            id="name"
            placeholder="e.g Yrika Marie R. Dusaran, PhD"
            class="flex-auto"
            autocomplete="off"
            [(ngModel)]="counterCheckedValue"
        />
    </div>
    <div class="flex align-items-center gap-3 mb-5">
        <label for="email" class="font-semibold w-6rem">Office</label>
        <input
            pInputText
            id="office"
            #officeInput
            placeholder="e.g Director for Quality Management"
            class="flex-auto"
            autocomplete="off"
            [(ngModel)]="counterCheckedofficeValue"
        />
    </div>

    <span class="p-text-secondary block mb-5">Verified By:</span>
    <div class="flex align-items-center gap-3 mb-3">
        <label for="username" class="font-semibold w-6rem">Name</label>
        <input
            pInputText
            #nameInput
            id="name"
            placeholder="e.g Rosalinda S. Tuvilla"
            class="flex-auto"
            autocomplete="off"
            [(ngModel)]="reviewedByValue"
        />
    </div>
    <div class="flex align-items-center gap-3 mb-5">
        <label for="email" class="font-semibold w-6rem">Office</label>
        <input
            pInputText
            id="office"
            #officeInput
            placeholder="e.g Chief Adminstrative Officer - Admin"
            class="flex-auto"
            autocomplete="off"
            [(ngModel)]="reviewedByofficeValue"
        />
    </div>

    <div class="flex justify-content-end gap-2">
        <p-button
            label="Cancel"
            severity="secondary"
            (onClick)="printingQOMHead = false"
        />
        <p-button
            label="Save"
            (onClick)="printQOMPdf(); printingQOMHead = false"
        />
    </div>
</p-dialog>

<table id="printQom" [ngClass]="{ hidden: !isPrintableVisible }">
    <thead>
        <tr class="font-condensed">
            <th rowspan="2" style="width: 10%">Indicators</th>
            <th rowspan="2" style="width: 7%">Target & Target Date</th>
            <th colspan="12">Performance</th>
            <th rowspan="2" style="width: 6%">Overall Result</th>
            <th rowspan="2" style="width: 8%">MOV/Data Source</th>
            <th rowspan="2" style="width: 22%">Remarks</th>
        </tr>
        <tr class="font-condensed">
            <th>Jan.</th>
            <th>Feb.</th>
            <th>Mar.</th>
            <th>Apr.</th>
            <th>May</th>
            <th>June</th>
            <th>July</th>
            <th>Aug.</th>
            <th>Sep.</th>
            <th>Oct.</th>
            <th>Nov.</th>
            <th>Dec.</th>
        </tr>
        <tr>
            <th class="border-x-0" colspan="17"></th>
        </tr>
    </thead>
    <tbody *ngIf="objectiveDatas?.length != 0">
        <tr *ngFor="let obj of objectiveDatas; let i = index">
            <td>{{ obj.performance_indicator | titlecase }}</td>
            <td>{{ obj.total }}</td>
            <td>
                @if( obj.monthPointer === 0){
                {{ obj.monthPointerValue.monthPointer_0 }}
                } @else { 0 }
            </td>
            <td>
                @if( obj.monthPointer === 1){
                {{ obj.monthPointerValue.monthPointer_1 }}
                }@else { 0 }
            </td>
            <td>
                @if( obj.monthPointer === 2){
                {{ obj.monthPointerValue.monthPointer_2 }}
                }@else { 0 }
            </td>
            <td>
                @if( obj.monthPointer === 3){
                {{ obj.monthPointerValue.monthPointer_3 }}
                }@else { 0 }
            </td>
            <td>
                @if( obj.monthPointer === 4){
                {{ obj.monthPointerValue.monthPointer_4 }}
                }@else { 0 }
            </td>
            <td>
                @if( obj.monthPointer === 5){
                {{ obj.monthPointerValue.monthPointer_5 }}
                }@else { 0 }
            </td>
            <td>
                @if( obj.monthPointer === 6){
                {{ obj.monthPointerValue.monthPointer_6 }}
                }@else { 0 }
            </td>
            <td>
                @if( obj.monthPointer === 7){
                {{ obj.monthPointerValue.monthPointer_7 }}
                }@else { 0 }
            </td>
            <td>
                @if( obj.monthPointer === 8){
                {{ obj.monthPointerValue.monthPointer_8 }}
                }@else { 0 }
            </td>
            <td>
                @if( obj.monthPointer === 9){
                {{ obj.monthPointerValue.monthPointer_9 }}
                }@else { 0 }
            </td>
            <td>
                @if( obj.monthPointer === 10){
                {{ obj.monthPointerValue.monthPointer_10 }}
                }@else { 0 }
            </td>
            <td>
                @if( obj.monthPointer === 11){
                {{ obj.monthPointerValue.monthPointer_11 }}
                }@else { 0 }
            </td>
            <td>
                {{ obj.total + "/" + obj.target }} @if(obj.target !==
                obj.total){ Ongoing} @else { Done}
            </td>
            <td>{{ obj.data_source }}</td>
            <td>
                @for(rem of obj.remarks; track rem._id){
                <br />
                <p>{{ rem.remarks }}</p>
                }
            </td>
        </tr>
    </tbody>
</table>
